<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Practice Lab: Neural Networks for Handwritten Digit Recognition, Binary &mdash; Machine Learning by Andrew Ng  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href="../../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Machine Learning by Andrew Ng
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Supervised_Machine_Learning_Regression_and_Classification/Supervised.html">Supervised_Machine_Learning</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Machine Learning by Andrew Ng</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Practice Lab: Neural Networks for Handwritten Digit Recognition, Binary</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/source_files/Advanced_Learning_Algorithms/week1/C2W1A1/C2_W1_Assignment.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Practice-Lab:-Neural-Networks-for-Handwritten-Digit-Recognition,-Binary">
<h1>Practice Lab: Neural Networks for Handwritten Digit Recognition, Binary<a class="headerlink" href="#Practice-Lab:-Neural-Networks-for-Handwritten-Digit-Recognition,-Binary" title="Permalink to this headline"></a></h1>
<p>In this exercise, you will use a neural network to recognize the hand-written digits zero and one.</p>
</section>
<section id="Outline">
<h1>Outline<a class="headerlink" href="#Outline" title="Permalink to this headline"></a></h1>
<ul class="simple">
<li><p>1 - Packages</p></li>
<li><p>2 - Neural Networks</p>
<ul>
<li><p>2.1 Problem Statement</p></li>
<li><p>2.2 Dataset</p></li>
<li><p>2.3 Model representation</p></li>
<li><p>2.4 Tensorflow Model Implementation</p>
<ul>
<li><p>Exercise 1</p></li>
</ul>
</li>
<li><p>2.5 NumPy Model Implementation (Forward Prop in NumPy)</p>
<ul>
<li><p>Exercise 2</p></li>
</ul>
</li>
<li><p>2.6 Vectorized NumPy Model Implementation (Optional)</p>
<ul>
<li><p>Exercise 3</p></li>
</ul>
</li>
<li><p>2.7 Congratulations!</p></li>
<li><p>2.8 NumPy Broadcasting Tutorial (Optional)</p></li>
</ul>
</li>
</ul>
<p>## 1 - Packages</p>
<p>First, let’s run the cell below to import all the packages that you will need during this assignment. - <a class="reference external" href="https://numpy.org/">numpy</a> is the fundamental package for scientific computing with Python. - <a class="reference external" href="http://matplotlib.org">matplotlib</a> is a popular library to plot graphs in Python. - <a class="reference external" href="https://www.tensorflow.org/">tensorflow</a> a popular platform for machine learning.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">autils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;tensorflow&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">autograph</span><span class="o">.</span><span class="n">set_verbosity</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line"><strong>Tensorflow and Keras</strong></div>
<div class="line">Tensorflow is a machine learning package developed by Google. In 2019, Google integrated Keras into Tensorflow and released Tensorflow 2.0. Keras is a framework developed independently by François Chollet that creates a simple, layer-centric interface to Tensorflow. This course will be using the Keras interface.</div>
</div>
<p>## 2 - Neural Networks</p>
<p>In Course 1, you implemented logistic regression. This was extended to handle non-linear boundaries using polynomial regression. For even more complex scenarios such as image recognition, neural networks are preferred.</p>
<p>### 2.1 Problem Statement</p>
<p>In this exercise, you will use a neural network to recognize two handwritten digits, zero and one. This is a binary classification task. Automated handwritten digit recognition is widely used today - from recognizing zip codes (postal codes) on mail envelopes to recognizing amounts written on bank checks. You will extend this network to recognize all 10 digits (0-9) in a future assignment.</p>
<p>This exercise will show you how the methods you have learned can be used for this classification task.</p>
<p>### 2.2 Dataset</p>
<p>You will start by loading the dataset for this task. - The <code class="docutils literal notranslate"><span class="pre">load_data()</span></code> function shown below loads the data into variables <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code></p>
<ul class="simple">
<li><p>The data set contains 1000 training examples of handwritten digits <span class="math notranslate nohighlight">\(^1\)</span>, here limited to zero and one.</p>
<ul>
<li><p>Each training example is a 20-pixel x 20-pixel grayscale image of the digit.</p>
<ul>
<li><p>Each pixel is represented by a floating-point number indicating the grayscale intensity at that location.</p></li>
<li><p>The 20 by 20 grid of pixels is “unrolled” into a 400-dimensional vector.</p></li>
<li><p>Each training example becomes a single row in our data matrix <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p></li>
<li><p>This gives us a 1000 x 400 matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> where every row is a training example of a handwritten digit image.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}X =
\left(\begin{array}{cc}
--- (x^{(1)}) --- \\
--- (x^{(2)}) --- \\
\vdots \\
--- (x^{(m)}) ---
\end{array}\right)\end{split}\]</div>
<ul class="simple">
<li><p>The second part of the training set is a 1000 x 1 dimensional vector <code class="docutils literal notranslate"><span class="pre">y</span></code> that contains labels for the training set</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">0</span></code> if the image is of the digit <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">1</span></code> if the image is of the digit <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
</ul>
</li>
</ul>
<p><span class="math notranslate nohighlight">\(^1\)</span> This is a subset of the MNIST handwritten digit dataset (<a class="reference external" href="http://yann.lecun.com/exdb/mnist/">http://yann.lecun.com/exdb/mnist/</a>)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load dataset</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line-block">
<div class="line">#### 2.2.1 View the variables Let’s get more familiar with your dataset.</div>
</div>
<div class="line">- A good place to start is to print out each variable and see what it contains.</div>
</div>
<p>The code below prints elements of the variables <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;The first element of X is: &#39;</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The first element of X is:  [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  8.56059680e-06
  1.94035948e-06 -7.37438725e-04 -8.13403799e-03 -1.86104473e-02
 -1.87412865e-02 -1.87572508e-02 -1.90963542e-02 -1.64039011e-02
 -3.78191381e-03  3.30347316e-04  1.27655229e-05  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  1.16421569e-04  1.20052179e-04
 -1.40444581e-02 -2.84542484e-02  8.03826593e-02  2.66540339e-01
  2.73853746e-01  2.78729541e-01  2.74293607e-01  2.24676403e-01
  2.77562977e-02 -7.06315478e-03  2.34715414e-04  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  1.28335523e-17 -3.26286765e-04 -1.38651604e-02
  8.15651552e-02  3.82800381e-01  8.57849775e-01  1.00109761e+00
  9.69710638e-01  9.30928598e-01  1.00383757e+00  9.64157356e-01
  4.49256553e-01 -5.60408259e-03 -3.78319036e-03  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  5.10620915e-06
  4.36410675e-04 -3.95509940e-03 -2.68537241e-02  1.00755014e-01
  6.42031710e-01  1.03136838e+00  8.50968614e-01  5.43122379e-01
  3.42599738e-01  2.68918777e-01  6.68374643e-01  1.01256958e+00
  9.03795598e-01  1.04481574e-01 -1.66424973e-02  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  2.59875260e-05
 -3.10606987e-03  7.52456076e-03  1.77539831e-01  7.92890120e-01
  9.65626503e-01  4.63166079e-01  6.91720680e-02 -3.64100526e-03
 -4.12180405e-02 -5.01900656e-02  1.56102907e-01  9.01762651e-01
  1.04748346e+00  1.51055252e-01 -2.16044665e-02  0.00000000e+00
  0.00000000e+00  0.00000000e+00  5.87012352e-05 -6.40931373e-04
 -3.23305249e-02  2.78203465e-01  9.36720163e-01  1.04320956e+00
  5.98003217e-01 -3.59409041e-03 -2.16751770e-02 -4.81021923e-03
  6.16566793e-05 -1.23773318e-02  1.55477482e-01  9.14867477e-01
  9.20401348e-01  1.09173902e-01 -1.71058007e-02  0.00000000e+00
  0.00000000e+00  1.56250000e-04 -4.27724104e-04 -2.51466503e-02
  1.30532561e-01  7.81664862e-01  1.02836583e+00  7.57137601e-01
  2.84667194e-01  4.86865128e-03 -3.18688725e-03  0.00000000e+00
  8.36492601e-04 -3.70751123e-02  4.52644165e-01  1.03180133e+00
  5.39028101e-01 -2.43742611e-03 -4.80290033e-03  0.00000000e+00
  0.00000000e+00 -7.03635621e-04 -1.27262443e-02  1.61706648e-01
  7.79865383e-01  1.03676705e+00  8.04490400e-01  1.60586724e-01
 -1.38173339e-02  2.14879493e-03 -2.12622549e-04  2.04248366e-04
 -6.85907627e-03  4.31712963e-04  7.20680947e-01  8.48136063e-01
  1.51383408e-01 -2.28404366e-02  1.98971950e-04  0.00000000e+00
  0.00000000e+00 -9.40410539e-03  3.74520505e-02  6.94389110e-01
  1.02844844e+00  1.01648066e+00  8.80488426e-01  3.92123945e-01
 -1.74122413e-02 -1.20098039e-04  5.55215142e-05 -2.23907271e-03
 -2.76068376e-02  3.68645493e-01  9.36411169e-01  4.59006723e-01
 -4.24701797e-02  1.17356610e-03  1.88929739e-05  0.00000000e+00
  0.00000000e+00 -1.93511951e-02  1.29999794e-01  9.79821705e-01
  9.41862388e-01  7.75147704e-01  8.73632241e-01  2.12778350e-01
 -1.72353349e-02  0.00000000e+00  1.09937426e-03 -2.61793751e-02
  1.22872879e-01  8.30812662e-01  7.26501773e-01  5.24441863e-02
 -6.18971913e-03  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -9.36563862e-03  3.68349741e-02  6.99079299e-01
  1.00293583e+00  6.05704402e-01  3.27299224e-01 -3.22099249e-02
 -4.83053002e-02 -4.34069138e-02 -5.75151144e-02  9.55674190e-02
  7.26512627e-01  6.95366966e-01  1.47114481e-01 -1.20048679e-02
 -3.02798203e-04  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00 -6.76572712e-04 -6.51415556e-03  1.17339359e-01
  4.21948410e-01  9.93210937e-01  8.82013974e-01  7.45758734e-01
  7.23874268e-01  7.23341725e-01  7.20020340e-01  8.45324959e-01
  8.31859739e-01  6.88831870e-02 -2.77765012e-02  3.59136710e-04
  7.14869281e-05  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  1.53186275e-04  3.17353553e-04 -2.29167177e-02
 -4.14402914e-03  3.87038450e-01  5.04583435e-01  7.74885876e-01
  9.90037446e-01  1.00769478e+00  1.00851440e+00  7.37905042e-01
  2.15455291e-01 -2.69624864e-02  1.32506127e-03  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  2.36366422e-04
 -2.26031454e-03 -2.51994485e-02 -3.73889910e-02  6.62121228e-02
  2.91134498e-01  3.23055726e-01  3.06260315e-01  8.76070942e-02
 -2.50581917e-02  2.37438725e-04  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  6.20939216e-18  6.72618320e-04 -1.13151411e-02
 -3.54641066e-02 -3.88214912e-02 -3.71077412e-02 -1.33524928e-02
  9.90964718e-04  4.89176960e-05  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;The first element of y is: &#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;The last element of y is: &#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The first element of y is:  0
The last element of y is:  1
</pre></div></div>
</div>
<p>#### 2.2.2 Check the dimensions of your variables</p>
<p>Another way to get familiar with your data is to view its dimensions. Please print the shape of <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and see how many training examples you have in your dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;The shape of X is: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;The shape of y is: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The shape of X is: (1000, 400)
The shape of y is: (1000, 1)
</pre></div></div>
</div>
<p>#### 2.2.3 Visualizing the Data</p>
<p>You will begin by visualizing a subset of the training set. - In the cell below, the code randomly selects 64 rows from <code class="docutils literal notranslate"><span class="pre">X</span></code>, maps each row back to a 20 pixel by 20 pixel grayscale image and displays the images together. - The label for each image is displayed above the image</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="c1"># You do not need to modify anything in this cell</span>

<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">):</span>
    <span class="c1"># Select random indices</span>
    <span class="n">random_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c1"># Select rows corresponding to the random indices and</span>
    <span class="c1"># reshape the image</span>
    <span class="n">X_random_reshaped</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">random_index</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Display the image</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_random_reshaped</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

    <span class="c1"># Display the label above the image</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">random_index</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_12_0.png" src="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_12_0.png" />
</div>
</div>
<p>### 2.3 Model representation</p>
<p>The neural network you will use in this assignment is shown in the figure below. - This has three dense layers with sigmoid activations. - Recall that our inputs are pixel values of digit images. - Since the images are of size <span class="math notranslate nohighlight">\(20\times20\)</span>, this gives us <span class="math notranslate nohighlight">\(400\)</span> inputs</p>
<p><img alt="4617512eebbc47868b59017ceb4e5f42" class="no-scaled-link" src="../../../../_images/C2_W1_Assign1.PNG" style="width: 500px; height: 400px;" /></p>
<ul class="simple">
<li><p>The parameters have dimensions that are sized for a neural network with <span class="math notranslate nohighlight">\(25\)</span> units in layer 1, <span class="math notranslate nohighlight">\(15\)</span> units in layer 2 and <span class="math notranslate nohighlight">\(1\)</span> output unit in layer 3.</p>
<ul>
<li><p>Recall that the dimensions of these parameters are determined as follows:</p>
<ul>
<li><p>If network has <span class="math notranslate nohighlight">\(s_{in}\)</span> units in a layer and <span class="math notranslate nohighlight">\(s_{out}\)</span> units in the next layer, then</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(W\)</span> will be of dimension <span class="math notranslate nohighlight">\(s_{in} \times s_{out}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> will a vector with <span class="math notranslate nohighlight">\(s_{out}\)</span> elements</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Therefore, the shapes of <code class="docutils literal notranslate"><span class="pre">W</span></code>, and <code class="docutils literal notranslate"><span class="pre">b</span></code>, are</p>
<ul>
<li><p>layer1: The shape of <code class="docutils literal notranslate"><span class="pre">W1</span></code> is (400, 25) and the shape of <code class="docutils literal notranslate"><span class="pre">b1</span></code> is (25,)</p></li>
<li><p>layer2: The shape of <code class="docutils literal notranslate"><span class="pre">W2</span></code> is (25, 15) and the shape of <code class="docutils literal notranslate"><span class="pre">b2</span></code> is: (15,)</p></li>
<li><p>layer3: The shape of <code class="docutils literal notranslate"><span class="pre">W3</span></code> is (15, 1) and the shape of <code class="docutils literal notranslate"><span class="pre">b3</span></code> is: (1,) &gt;<strong>Note:</strong> The bias vector <code class="docutils literal notranslate"><span class="pre">b</span></code> could be represented as a 1-D (n,) or 2-D (n,1) array. Tensorflow utilizes a 1-D representation and this lab will maintain that convention.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>### 2.4 Tensorflow Model Implementation</p>
<div class="line-block">
<div class="line">Tensorflow models are built layer by layer. A layer’s input dimensions (<span class="math notranslate nohighlight">\(s_{in}\)</span> above) are calculated for you. You specify a layer’s <em>output dimensions</em> and this determines the next layer’s input dimension. The input dimension of the first layer is derived from the size of the input data specified in the <code class="docutils literal notranslate"><span class="pre">model.fit</span></code> statment below. &gt;<strong>Note:</strong> It is also possible to add an input layer that specifies the input dimension of the first layer. For example:</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">tf.keras.Input(shape=(400,)),</span>&#160;&#160;&#160; <span class="pre">#specify</span> <span class="pre">input</span> <span class="pre">shape</span></code></div>
<div class="line">We will include that here to illuminate some model sizing.</div>
</div>
<p>### Exercise 1</p>
<p>Below, using Keras <a class="reference external" href="https://keras.io/guides/sequential_model/">Sequential model</a> and <a class="reference external" href="https://keras.io/api/layers/core_layers/dense/">Dense Layer</a> with a sigmoid activation to construct the network described above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># UNQ_C1</span>
<span class="c1"># GRADED CELL: Sequential model</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,)),</span>    <span class="c1">#specify input size</span>
        <span class="c1">### START CODE HERE ###</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">)</span>
        <span class="c1">### END CODE HERE ###</span>
    <span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;my_model&quot;</span>
<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model: &#34;my_model&#34;
_________________________________________________________________
 Layer (type)                Output Shape              Param #
=================================================================
 dense (Dense)               (None, 25)                10025

 dense_1 (Dense)             (None, 15)                390

 dense_2 (Dense)             (None, 1)                 16

=================================================================
Total params: 10,431
Trainable params: 10,431
Non-trainable params: 0
_________________________________________________________________
</pre></div></div>
</div>
<details><p>Expected Output (Click to Expand) The <code class="docutils literal notranslate"><span class="pre">model.summary()</span></code> function displays a useful summary of the model. Because we have specified an input layer size, the shape of the weight and bias arrays are determined and the total number of parameters per layer can be shown. Note, the names of the layers may vary as they are auto-generated.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Model: &quot;my_model&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
dense (Dense)                (None, 25)                10025
_________________________________________________________________
dense_1 (Dense)              (None, 15)                390
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 16
=================================================================
Total params: 10,431
Trainable params: 10,431
Non-trainable params: 0
_________________________________________________________________
</pre></div>
</div>
<details><p>Click for hints As described in the lecture:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,)),</span>    <span class="c1"># specify input size (optional)</span>
        <span class="n">Dense</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">),</span>
        <span class="n">Dense</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">),</span>
        <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span>  <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">)</span>
    <span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;my_model&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># UNIT TESTS</span>
<span class="kn">from</span> <span class="nn">public_tests</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">test_c1</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-green-intense-fg">All tests passed!</span>
</pre></div></div>
</div>
<p>The parameter counts shown in the summary correspond to the number of elements in the weight and bias arrays as shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L1_num_params</span> <span class="o">=</span> <span class="mi">400</span> <span class="o">*</span> <span class="mi">25</span> <span class="o">+</span> <span class="mi">25</span>  <span class="c1"># W1 parameters  + b1 parameters</span>
<span class="n">L2_num_params</span> <span class="o">=</span> <span class="mi">25</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="mi">15</span>   <span class="c1"># W2 parameters  + b2 parameters</span>
<span class="n">L3_num_params</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>     <span class="c1"># W3 parameters  + b3 parameters</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;L1 params = &quot;</span><span class="p">,</span> <span class="n">L1_num_params</span><span class="p">,</span> <span class="s2">&quot;, L2 params = &quot;</span><span class="p">,</span> <span class="n">L2_num_params</span><span class="p">,</span> <span class="s2">&quot;,  L3 params = &quot;</span><span class="p">,</span> <span class="n">L3_num_params</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
L1 params =  10025 , L2 params =  390 ,  L3 params =  16
</pre></div></div>
</div>
<p>Let’s further examine the weights to verify that tensorflow produced the same dimensions as we calculated above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">layer1</span><span class="p">,</span> <span class="n">layer2</span><span class="p">,</span> <span class="n">layer3</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#### Examine Weights shapes</span>
<span class="n">W1</span><span class="p">,</span><span class="n">b1</span> <span class="o">=</span> <span class="n">layer1</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
<span class="n">W2</span><span class="p">,</span><span class="n">b2</span> <span class="o">=</span> <span class="n">layer2</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
<span class="n">W3</span><span class="p">,</span><span class="n">b3</span> <span class="o">=</span> <span class="n">layer3</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;W1 shape = </span><span class="si">{</span><span class="n">W1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, b1 shape = </span><span class="si">{</span><span class="n">b1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;W2 shape = </span><span class="si">{</span><span class="n">W2</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, b2 shape = </span><span class="si">{</span><span class="n">b2</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;W3 shape = </span><span class="si">{</span><span class="n">W3</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, b3 shape = </span><span class="si">{</span><span class="n">b3</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
W1 shape = (400, 25), b1 shape = (25,)
W2 shape = (25, 15), b2 shape = (15,)
W3 shape = (15, 1), b3 shape = (1,)
</pre></div></div>
</div>
<p><strong>Expected Output</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>W1 shape = (400, 25), b1 shape = (25,)
W2 shape = (25, 15), b2 shape = (15,)
W3 shape = (15, 1), b3 shape = (1,)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">xx.get_weights</span></code> returns a NumPy array. One can also access the weights directly in their tensor form. Note the shape of the tensors in the final layer.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;tf.Variable &#39;dense_2/kernel:0&#39; shape=(15, 1) dtype=float32, numpy=
array([[-0.08530456],
       [-0.2747036 ],
       [ 0.08510572],
       [-0.12527409],
       [-0.2926382 ],
       [-0.34840912],
       [ 0.21684825],
       [-0.08979291],
       [ 0.5360281 ],
       [ 0.19300771],
       [-0.44613487],
       [ 0.1397686 ],
       [-0.42860353],
       [ 0.5345983 ],
       [ 0.22546476]], dtype=float32)&gt;, &lt;tf.Variable &#39;dense_2/bias:0&#39; shape=(1,) dtype=float32, numpy=array([0.], dtype=float32)&gt;]
</pre></div></div>
</div>
<p>The following code will define a loss function and run gradient descent to fit the weights of the model to the training data. This will be explained in more detail in the following week.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">(),</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 1/20
32/32 [==============================] - 0s 1ms/step - loss: 0.6348
Epoch 2/20
32/32 [==============================] - 0s 1ms/step - loss: 0.4996
Epoch 3/20
32/32 [==============================] - 0s 2ms/step - loss: 0.3573
Epoch 4/20
32/32 [==============================] - 0s 1ms/step - loss: 0.2490
Epoch 5/20
32/32 [==============================] - 0s 2ms/step - loss: 0.1787
Epoch 6/20
32/32 [==============================] - 0s 1ms/step - loss: 0.1338
Epoch 7/20
32/32 [==============================] - 0s 1ms/step - loss: 0.1047
Epoch 8/20
32/32 [==============================] - 0s 2ms/step - loss: 0.0848
Epoch 9/20
32/32 [==============================] - 0s 1ms/step - loss: 0.0708
Epoch 10/20
32/32 [==============================] - 0s 2ms/step - loss: 0.0600
Epoch 11/20
32/32 [==============================] - 0s 1ms/step - loss: 0.0520
Epoch 12/20
32/32 [==============================] - 0s 2ms/step - loss: 0.0456
Epoch 13/20
32/32 [==============================] - 0s 1ms/step - loss: 0.0405
Epoch 14/20
32/32 [==============================] - 0s 2ms/step - loss: 0.0365
Epoch 15/20
32/32 [==============================] - 0s 2ms/step - loss: 0.0332
Epoch 16/20
32/32 [==============================] - 0s 1ms/step - loss: 0.0304
Epoch 17/20
32/32 [==============================] - 0s 2ms/step - loss: 0.0280
Epoch 18/20
32/32 [==============================] - 0s 1ms/step - loss: 0.0260
Epoch 19/20
32/32 [==============================] - 0s 2ms/step - loss: 0.0243
Epoch 20/20
32/32 [==============================] - 0s 1ms/step - loss: 0.0228
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;keras.callbacks.History at 0x7f2d2b00a650&gt;
</pre></div></div>
</div>
<p>To run the model on an example to make a prediction, use <cite>Keras ``predict`</cite> &lt;<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/Model">https://www.tensorflow.org/api_docs/python/tf/keras/Model</a>&gt;`__. The input to <code class="docutils literal notranslate"><span class="pre">predict</span></code> is an array so the single example is reshaped to be two dimensional.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>  <span class="c1"># a zero</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; predicting a zero: </span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">500</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>  <span class="c1"># a one</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; predicting a one:  </span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 predicting a zero: [[0.01574531]]
 predicting a one:  [[0.98137283]]
</pre></div></div>
</div>
<p>The output of the model is interpreted as a probability. In the first example above, the input is a zero. The model predicts the probability that the input is a one is nearly zero. In the second example, the input is a one. The model predicts the probability that the input is a one is nearly one. As in the case of logistic regression, the probability is compared to a threshold to make a final prediction.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">prediction</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prediction after threshold: </span><span class="si">{</span><span class="n">yhat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
prediction after threshold: 1
</pre></div></div>
</div>
<p>Let’s compare the predictions vs the labels for a random sample of 64 digits. This takes a moment to run.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="c1"># You do not need to modify anything in this cell</span>

<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">])</span> <span class="c1">#[left, bottom, right, top]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">):</span>
    <span class="c1"># Select random indices</span>
    <span class="n">random_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c1"># Select rows corresponding to the random indices and</span>
    <span class="c1"># reshape the image</span>
    <span class="n">X_random_reshaped</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">random_index</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Display the image</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_random_reshaped</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

    <span class="c1"># Predict using the Neural Network</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">random_index</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">prediction</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="n">yhat</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">yhat</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Display the label above the image</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">random_index</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">yhat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Label, yhat&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_38_0.png" src="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_38_0.png" />
</div>
</div>
<p>### 2.5 NumPy Model Implementation (Forward Prop in NumPy) As described in lecture, it is possible to build your own dense layer using NumPy. This can then be utilized to build a multi-layer neural network.</p>
<p><img alt="5960530c79a14c0c8a839c68ff62f985" class="no-scaled-link" src="../../../../_images/C2_W1_dense2.PNG" style="width: 600px; height: 450px;" /></p>
<p>### Exercise 2</p>
<p>Below, build a dense layer subroutine. The example in lecture utilized a for loop to visit each unit (<code class="docutils literal notranslate"><span class="pre">j</span></code>) in the layer and perform the dot product of the weights for that unit (<code class="docutils literal notranslate"><span class="pre">W[:,j]</span></code>) and sum the bias for the unit (<code class="docutils literal notranslate"><span class="pre">b[j]</span></code>) to form <code class="docutils literal notranslate"><span class="pre">z</span></code>. An activation function <code class="docutils literal notranslate"><span class="pre">g(z)</span></code> is then applied to that result. This section will not utilize some of the matrix operations described in the optional lectures. These will be explored in a later section.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># UNQ_C2</span>
<span class="c1"># GRADED FUNCTION: my_dense</span>

<span class="k">def</span> <span class="nf">my_dense</span><span class="p">(</span><span class="n">a_in</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes dense layer</span>
<span class="sd">    Args:</span>
<span class="sd">      a_in (ndarray (n, )) : Data, 1 example</span>
<span class="sd">      W    (ndarray (n,j)) : Weight matrix, n features per unit, j units</span>
<span class="sd">      b    (ndarray (j, )) : bias vector, j units</span>
<span class="sd">      g    activation function (e.g. sigmoid, relu..)</span>
<span class="sd">    Returns</span>
<span class="sd">      a_out (ndarray (j,))  : j units</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
<span class="c1">### START CODE HERE ###</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">units</span><span class="p">):</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
        <span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">a_in</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">a_out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">g</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="c1">### END CODE HERE ###</span>
    <span class="k">return</span><span class="p">(</span><span class="n">a_out</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Quick Check</span>
<span class="n">x_tst</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,)</span>  <span class="c1"># (1 examples, 2 features)</span>
<span class="n">W_tst</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># (2 input features, 3 output features)</span>
<span class="n">b_tst</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,)</span>  <span class="c1"># (3 features)</span>
<span class="n">A_tst</span> <span class="o">=</span> <span class="n">my_dense</span><span class="p">(</span><span class="n">x_tst</span><span class="p">,</span> <span class="n">W_tst</span><span class="p">,</span> <span class="n">b_tst</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.54735762 0.57932425 0.61063923]
</pre></div></div>
</div>
<p><strong>Expected Output</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[0.54735762 0.57932425 0.61063923]
</pre></div>
</div>
<details><p>Click for hints As described in the lecture:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_dense</span><span class="p">(</span><span class="n">a_in</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes dense layer</span>
<span class="sd">    Args:</span>
<span class="sd">      a_in (ndarray (n, )) : Data, 1 example</span>
<span class="sd">      W    (ndarray (n,j)) : Weight matrix, n features per unit, j units</span>
<span class="sd">      b    (ndarray (j, )) : bias vector, j units</span>
<span class="sd">      g    activation function (e.g. sigmoid, relu..)</span>
<span class="sd">    Returns</span>
<span class="sd">      a_out (ndarray (j,))  : j units</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">units</span><span class="p">):</span>
        <span class="n">w</span> <span class="o">=</span>                            <span class="c1"># Select weights for unit j. These are in column j of W</span>
        <span class="n">z</span> <span class="o">=</span>                            <span class="c1"># dot product of w and a_in + b</span>
        <span class="n">a_out</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span>                     <span class="c1"># apply activation to z</span>
    <span class="k">return</span><span class="p">(</span><span class="n">a_out</span><span class="p">)</span>
</pre></div>
</div>
<details><p>Click for more hints</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_dense</span><span class="p">(</span><span class="n">a_in</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes dense layer</span>
<span class="sd">    Args:</span>
<span class="sd">      a_in (ndarray (n, )) : Data, 1 example</span>
<span class="sd">      W    (ndarray (n,j)) : Weight matrix, n features per unit, j units</span>
<span class="sd">      b    (ndarray (j, )) : bias vector, j units</span>
<span class="sd">      g    activation function (e.g. sigmoid, relu..)</span>
<span class="sd">    Returns</span>
<span class="sd">      a_out (ndarray (j,))  : j units</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">units</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">units</span><span class="p">):</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">a_in</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">a_out</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">a_out</span><span class="p">)</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># UNIT TESTS</span>
<span class="n">test_c2</span><span class="p">(</span><span class="n">my_dense</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-green-intense-fg">All tests passed!</span>
</pre></div></div>
</div>
<p>The following cell builds a three-layer neural network utilizing the <code class="docutils literal notranslate"><span class="pre">my_dense</span></code> subroutine above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_sequential</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">W3</span><span class="p">,</span> <span class="n">b3</span><span class="p">):</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">my_dense</span><span class="p">(</span><span class="n">x</span><span class="p">,</span>  <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">)</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">my_dense</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">)</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="n">my_dense</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">W3</span><span class="p">,</span> <span class="n">b3</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">a3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can copy trained weights and biases from Tensorflow.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W1_tmp</span><span class="p">,</span><span class="n">b1_tmp</span> <span class="o">=</span> <span class="n">layer1</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
<span class="n">W2_tmp</span><span class="p">,</span><span class="n">b2_tmp</span> <span class="o">=</span> <span class="n">layer2</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
<span class="n">W3_tmp</span><span class="p">,</span><span class="n">b3_tmp</span> <span class="o">=</span> <span class="n">layer3</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make predictions</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">my_sequential</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">W1_tmp</span><span class="p">,</span> <span class="n">b1_tmp</span><span class="p">,</span> <span class="n">W2_tmp</span><span class="p">,</span> <span class="n">b2_tmp</span><span class="p">,</span> <span class="n">W3_tmp</span><span class="p">,</span> <span class="n">b3_tmp</span> <span class="p">)</span>
<span class="k">if</span> <span class="n">prediction</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;yhat = &quot;</span><span class="p">,</span> <span class="n">yhat</span><span class="p">,</span> <span class="s2">&quot; label= &quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">my_sequential</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">500</span><span class="p">],</span> <span class="n">W1_tmp</span><span class="p">,</span> <span class="n">b1_tmp</span><span class="p">,</span> <span class="n">W2_tmp</span><span class="p">,</span> <span class="n">b2_tmp</span><span class="p">,</span> <span class="n">W3_tmp</span><span class="p">,</span> <span class="n">b3_tmp</span> <span class="p">)</span>
<span class="k">if</span> <span class="n">prediction</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;yhat = &quot;</span><span class="p">,</span> <span class="n">yhat</span><span class="p">,</span> <span class="s2">&quot; label= &quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
yhat =  0  label=  0
yhat =  1  label=  1
</pre></div></div>
</div>
<p>Run the following cell to see predictions from both the Numpy model and the Tensorflow model. This takes a moment to run.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="c1"># You do not need to modify anything in this cell</span>

<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">])</span> <span class="c1">#[left, bottom, right, top]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">):</span>
    <span class="c1"># Select random indices</span>
    <span class="n">random_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c1"># Select rows corresponding to the random indices and</span>
    <span class="c1"># reshape the image</span>
    <span class="n">X_random_reshaped</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">random_index</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Display the image</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_random_reshaped</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

    <span class="c1"># Predict using the Neural Network implemented in Numpy</span>
    <span class="n">my_prediction</span> <span class="o">=</span> <span class="n">my_sequential</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">random_index</span><span class="p">],</span> <span class="n">W1_tmp</span><span class="p">,</span> <span class="n">b1_tmp</span><span class="p">,</span> <span class="n">W2_tmp</span><span class="p">,</span> <span class="n">b2_tmp</span><span class="p">,</span> <span class="n">W3_tmp</span><span class="p">,</span> <span class="n">b3_tmp</span> <span class="p">)</span>
    <span class="n">my_yhat</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">my_prediction</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Predict using the Neural Network implemented in Tensorflow</span>
    <span class="n">tf_prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">random_index</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">400</span><span class="p">))</span>
    <span class="n">tf_yhat</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tf_prediction</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Display the label above the image</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">random_index</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">tf_yhat</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">my_yhat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Label, yhat Tensorflow, yhat Numpy&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_52_0.png" src="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_52_0.png" />
</div>
</div>
<p>### 2.6 Vectorized NumPy Model Implementation (Optional) The optional lectures described vector and matrix operations that can be used to speed the calculations. Below describes a layer operation that computes the output for all units in a layer on a given input example:</p>
<p><img alt="a187e56c01fe4a56a5fed352b2993bb6" class="no-scaled-link" src="../../../../_images/C2_W1_VectorMatrix.PNG" style="width: 600px; height: 450px;" /></p>
<p>We can demonstrate this using the examples <code class="docutils literal notranslate"><span class="pre">X</span></code> and the <code class="docutils literal notranslate"><span class="pre">W1</span></code>,<code class="docutils literal notranslate"><span class="pre">b1</span></code> parameters above. We use <code class="docutils literal notranslate"><span class="pre">np.matmul</span></code> to perform the matrix multiply. Note, the dimensions of x and W must be compatible as shown in the diagram above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>         <span class="c1"># column vector (400,1)</span>
<span class="n">z1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">W1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b1</span>    <span class="c1"># (1,400)(400,25) = (1,25)</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 25)
</pre></div></div>
</div>
<p>You can take this a step further and compute all the units for all examples in one Matrix-Matrix operation.</p>
<p><img alt="0d54c338e8954735b950bcc5bccd7642" class="no-scaled-link" src="../../../../_images/C2_W1_MatrixMatrix.PNG" style="width: 600px; height: 450px;" /> The full operation is <span class="math notranslate nohighlight">\(\mathbf{Z}=\mathbf{XW}+\mathbf{b}\)</span>. This will utilize NumPy broadcasting to expand <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> to <span class="math notranslate nohighlight">\(m\)</span> rows. If this is unfamiliar, a short tutorial is provided at the end of the notebook.</p>
<p>### Exercise 3</p>
<p>Below, compose a new <code class="docutils literal notranslate"><span class="pre">my_dense_v</span></code> subroutine that performs the layer calculations for a matrix of examples. This will utilize <code class="docutils literal notranslate"><span class="pre">np.matmul()</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># UNQ_C3</span>
<span class="c1"># GRADED FUNCTION: my_dense_v</span>

<span class="k">def</span> <span class="nf">my_dense_v</span><span class="p">(</span><span class="n">A_in</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes dense layer</span>
<span class="sd">    Args:</span>
<span class="sd">      A_in (ndarray (m,n)) : Data, m examples, n features each</span>
<span class="sd">      W    (ndarray (n,j)) : Weight matrix, n features per unit, j units</span>
<span class="sd">      b    (ndarray (1,j)) : bias vector, j units</span>
<span class="sd">      g    activation function (e.g. sigmoid, relu..)</span>
<span class="sd">    Returns</span>
<span class="sd">      A_out (ndarray (m,j)) : m examples, j units</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">### START CODE HERE ###</span>
    <span class="n">A_out</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A_in</span><span class="p">,</span><span class="n">W</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

<span class="c1">### END CODE HERE ###</span>
    <span class="k">return</span><span class="p">(</span><span class="n">A_out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_tst</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># (4 examples, 2 features)</span>
<span class="n">W_tst</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># (2 input features, 3 output features)</span>
<span class="n">b_tst</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># (1, 3 features)</span>
<span class="n">A_tst</span> <span class="o">=</span> <span class="n">my_dense_v</span><span class="p">(</span><span class="n">X_tst</span><span class="p">,</span> <span class="n">W_tst</span><span class="p">,</span> <span class="n">b_tst</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A_tst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
tf.Tensor(
[[0.54735762 0.57932425 0.61063923]
 [0.57199613 0.61301418 0.65248946]
 [0.5962827  0.64565631 0.6921095 ]
 [0.62010643 0.67699586 0.72908792]], shape=(4, 3), dtype=float64)
</pre></div></div>
</div>
<p><strong>Expected Output</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[0.54735762 0.57932425 0.61063923]
 [0.57199613 0.61301418 0.65248946]
 [0.5962827  0.64565631 0.6921095 ]
 [0.62010643 0.67699586 0.72908792]]
</pre></div>
</div>
<details><p>Click for hints In matrix form, this can be written in one or two lines.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Z = np.matmul of A_in and W plus b
  A_out is g(Z)
</pre></div>
</div>
<details><p>Click for code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_dense_v</span><span class="p">(</span><span class="n">A_in</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes dense layer</span>
<span class="sd">    Args:</span>
<span class="sd">      A_in (ndarray (m,n)) : Data, m examples, n features each</span>
<span class="sd">      W    (ndarray (n,j)) : Weight matrix, n features per unit, j units</span>
<span class="sd">      b    (ndarray (j,1)) : bias vector, j units</span>
<span class="sd">      g    activation function (e.g. sigmoid, relu..)</span>
<span class="sd">    Returns</span>
<span class="sd">      A_out (ndarray (m,j)) : m examples, j units</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A_in</span><span class="p">,</span><span class="n">W</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
    <span class="n">A_out</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">A_out</span><span class="p">)</span>
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># UNIT TESTS</span>
<span class="n">test_c3</span><span class="p">(</span><span class="n">my_dense_v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-green-intense-fg">All tests passed!</span>
</pre></div></div>
</div>
<p>The following cell builds a three-layer neural network utilizing the <code class="docutils literal notranslate"><span class="pre">my_dense_v</span></code> subroutine above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_sequential_v</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">W3</span><span class="p">,</span> <span class="n">b3</span><span class="p">):</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="n">my_dense_v</span><span class="p">(</span><span class="n">X</span><span class="p">,</span>  <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">)</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="n">my_dense_v</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">)</span>
    <span class="n">A3</span> <span class="o">=</span> <span class="n">my_dense_v</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="n">W3</span><span class="p">,</span> <span class="n">b3</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">A3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can again copy trained weights and biases from Tensorflow.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W1_tmp</span><span class="p">,</span><span class="n">b1_tmp</span> <span class="o">=</span> <span class="n">layer1</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
<span class="n">W2_tmp</span><span class="p">,</span><span class="n">b2_tmp</span> <span class="o">=</span> <span class="n">layer2</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
<span class="n">W3_tmp</span><span class="p">,</span><span class="n">b3_tmp</span> <span class="o">=</span> <span class="n">layer3</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Let’s make a prediction with the new model. This will make a prediction on <em>all of the examples at once</em>. Note the shape of the output.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Prediction</span> <span class="o">=</span> <span class="n">my_sequential_v</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W1_tmp</span><span class="p">,</span> <span class="n">b1_tmp</span><span class="p">,</span> <span class="n">W2_tmp</span><span class="p">,</span> <span class="n">b2_tmp</span><span class="p">,</span> <span class="n">W3_tmp</span><span class="p">,</span> <span class="n">b3_tmp</span> <span class="p">)</span>
<span class="n">Prediction</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TensorShape([1000, 1])
</pre></div></div>
</div>
<p>We’ll apply a threshold of 0.5 as before, but to all predictions at once.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Yhat</span> <span class="o">=</span> <span class="p">(</span><span class="n">Prediction</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;predict a zero: &quot;</span><span class="p">,</span><span class="n">Yhat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;predict a one: &quot;</span><span class="p">,</span> <span class="n">Yhat</span><span class="p">[</span><span class="mi">500</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
predict a zero:  [0] predict a one:  [1]
</pre></div></div>
</div>
<p>Run the following cell to see predictions. This will use the predictions we just calculated above. This takes a moment to run.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="c1"># You do not need to modify anything in this cell</span>

<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">])</span> <span class="c1">#[left, bottom, right, top]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">):</span>
    <span class="c1"># Select random indices</span>
    <span class="n">random_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c1"># Select rows corresponding to the random indices and</span>
    <span class="c1"># reshape the image</span>
    <span class="n">X_random_reshaped</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">random_index</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Display the image</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_random_reshaped</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

    <span class="c1"># Display the label above the image</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">random_index</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">Yhat</span><span class="p">[</span><span class="n">random_index</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Label, Yhat&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_71_0.png" src="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_71_0.png" />
</div>
</div>
<p>You can see how one of the misclassified images looks.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">!=</span> <span class="n">Yhat</span><span class="p">)</span>
<span class="n">random_index</span> <span class="o">=</span> <span class="n">errors</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">X_random_reshaped</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">random_index</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_random_reshaped</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y</span><span class="p">[</span><span class="n">random_index</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">Yhat</span><span class="p">[</span><span class="n">random_index</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_73_0.png" src="../../../../_images/source_files_Advanced_Learning_Algorithms_week1_C2W1A1_C2_W1_Assignment_73_0.png" />
</div>
</div>
<p>### 2.7 Congratulations! You have successfully built and utilized a neural network.</p>
<p>### 2.8 NumPy Broadcasting Tutorial (Optional)</p>
<p>In the last example, <span class="math notranslate nohighlight">\(\mathbf{Z}=\mathbf{XW} + \mathbf{b}\)</span> utilized NumPy broadcasting to expand the vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>. If you are not familiar with NumPy Broadcasting, this short tutorial is provided.</p>
<p><span class="math notranslate nohighlight">\(\mathbf{XW}\)</span> is a matrix-matrix operation with dimensions <span class="math notranslate nohighlight">\((m,j_1)(j_1,j_2)\)</span> which results in a matrix with dimension <span class="math notranslate nohighlight">\((m,j_2)\)</span>. To that, we add a vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> with dimension <span class="math notranslate nohighlight">\((1,j_2)\)</span>. <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> must be expanded to be a <span class="math notranslate nohighlight">\((m,j_2)\)</span> matrix for this element-wise operation to make sense. This expansion is accomplished for you by NumPy broadcasting.</p>
<div class="line-block">
<div class="line">Broadcasting applies to element-wise operations.</div>
<div class="line">Its basic operation is to ‘stretch’ a smaller dimension by replicating elements to match a larger dimension.</div>
</div>
<p>More <a class="reference external" href="https://NumPy.org/doc/stable/user/basics.broadcasting.html">specifically</a>: When operating on two arrays, NumPy compares their shapes element-wise. It starts with the trailing (i.e. rightmost) dimensions and works its way left. Two dimensions are compatible when - they are equal, or - one of them is 1</p>
<p>If these conditions are not met, a ValueError: operands could not be broadcast together exception is thrown, indicating that the arrays have incompatible shapes. The size of the resulting array is the size that is not 1 along each axis of the inputs.</p>
<p>Here are some examples:</p>
<figure><center><p><img alt="missing" class="no-scaled-link" src="../../../../_images/C2_W1_Assign1_BroadcastIndexes.PNG" style="width: 400px;" /></p>
<center/><figcaption><p>Calculating Broadcast Result shape</p>
</figcaption><figure/><p>The graphic below describes expanding dimensions. Note the red text below:</p>
<figure><center><p><img alt="missing" class="no-scaled-link" src="../../../../_images/C2_W1_Assign1_Broadcasting.gif" style="width: 600px;" /></p>
<center/><figcaption><p>Broadcast notionally expands arguments to match for element wise operations</p>
</figcaption><figure/><p>The graphic above shows NumPy expanding the arguments to match before the final operation. Note that this is a notional description. The actual mechanics of NumPy operation choose the most efficient implementation.</p>
<p>For each of the following examples, try to guess the size of the result before running the example.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#(3,1)</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(a + b).shape: </span><span class="si">{</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, </span><span class="se">\n</span><span class="s2">a + b = </span><span class="se">\n</span><span class="si">{</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(a + b).shape: (3, 1),
a + b =
[[6]
 [7]
 [8]]
</pre></div></div>
</div>
<p>Note that this applies to all element-wise operations:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#(3,1)</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(a * b).shape: </span><span class="si">{</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, </span><span class="se">\n</span><span class="s2">a * b = </span><span class="se">\n</span><span class="si">{</span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(a * b).shape: (3, 1),
a * b =
[[ 5]
 [10]
 [15]]
</pre></div></div>
</div>
<figure><p><img alt="missing" class="no-scaled-link" src="../../../../_images/C2_W1_Assign1_VectorAdd.PNG" style="width: 740px;" /></p>
<center><figcaption><p>Row-Column Element-Wise Operations</p>
</figcaption></center><figure/><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(a + b).shape: </span><span class="si">{</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, </span><span class="se">\n</span><span class="s2">a + b = </span><span class="se">\n</span><span class="si">{</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1]
 [2]
 [3]
 [4]]
[[1 2 3]]
(a + b).shape: (4, 3),
a + b =
[[2 3 4]
 [3 4 5]
 [4 5 6]
 [5 6 7]]
</pre></div></div>
</div>
<p>This is the scenario in the dense layer you built above. Adding a 1-D vector <span class="math notranslate nohighlight">\(b\)</span> to a (m,j) matrix.</p>
<figure><p><img alt="missing" class="no-scaled-link" src="../../../../_images/C2_W1_Assign1_BroadcastMatrix.PNG" style="width: 740px;" /></p>
<center><figcaption><p>Matrix + 1-D Vector</p>
</figcaption></center><figure/><div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andrew Ng.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>