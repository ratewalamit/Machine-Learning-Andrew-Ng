<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Optional Lab: Cost Function &mdash; Machine Learning by Andrew Ng  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href="../../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Machine Learning by Andrew Ng
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Supervised.html">Supervised_Machine_Learning</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Machine Learning by Andrew Ng</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Optional Lab: Cost Function</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/source_files/Supervised_Machine_Learning_Regression_and_Classification/week1/Optional_Labs/C1_W1_Lab04_Cost_function_Soln.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Optional-Lab:-Cost-Function">
<h1>Optional Lab: Cost Function<a class="headerlink" href="#Optional-Lab:-Cost-Function" title="Permalink to this headline"></a></h1>
<figure><center><p><img alt="19cfe6ab161747478f2fd7f991ddf1ef" src="../../../../_images/C1_W1_L3_S2_Lecture_b.png" /></p>
</center></figure><section id="Goals">
<h2>Goals<a class="headerlink" href="#Goals" title="Permalink to this headline"></a></h2>
<p>In this lab you will: - you will implement and explore the <code class="docutils literal notranslate"><span class="pre">cost</span></code> function for linear regression with one variable.</p>
</section>
<section id="Tools">
<h2>Tools<a class="headerlink" href="#Tools" title="Permalink to this headline"></a></h2>
<p>In this lab we will make use of: - NumPy, a popular library for scientific computing - Matplotlib, a popular library for plotting data - local plotting routines in the lab_utils_uni.py file in the local directory</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> widget
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">lab_utils_uni</span> <span class="kn">import</span> <span class="n">plt_intuition</span><span class="p">,</span> <span class="n">plt_stationary</span><span class="p">,</span> <span class="n">plt_update_onclick</span><span class="p">,</span> <span class="n">soup_bowl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;./deeplearning.mplstyle&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Problem-Statement">
<h2>Problem Statement<a class="headerlink" href="#Problem-Statement" title="Permalink to this headline"></a></h2>
<div class="line-block">
<div class="line">You would like a model which can predict housing prices given the size of the house.</div>
<div class="line">Let’s use the same two data points as before the previous lab- a house with 1000 square feet sold for \$300,000 and a house with 2000 square feet sold for \$500,000.</div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Size (1000 sqft)</p></th>
<th class="head"><p>Price (1000s of dollars)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>300</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>500</p></td>
</tr>
</tbody>
</table>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>           <span class="c1">#(size in 1000 square feet)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">300.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">])</span>           <span class="c1">#(price in 1000s of dollars)</span>
</pre></div>
</div>
</div>
</section>
<section id="Computing-Cost">
<h2>Computing Cost<a class="headerlink" href="#Computing-Cost" title="Permalink to this headline"></a></h2>
<p>The term ‘cost’ in this assignment might be a little confusing since the data is housing cost. Here, cost is a measure how well our model is predicting the target price of the house. The term ‘price’ is used for housing data.</p>
<p>The equation for cost with one variable is:</p>
<div class="math notranslate nohighlight">
\[J(w,b) = \frac{1}{2m} \sum\limits_{i = 0}^{m-1} (f_{w,b}(x^{(i)}) - y^{(i)})^2 \tag{1}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[f_{w,b}(x^{(i)}) = wx^{(i)} + b \tag{2}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f_{w,b}(x^{(i)})\)</span> is our prediction for example <span class="math notranslate nohighlight">\(i\)</span> using parameters <span class="math notranslate nohighlight">\(w,b\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\((f_{w,b}(x^{(i)}) -y^{(i)})^2\)</span> is the squared difference between the target value and the prediction.</p></li>
<li><p>These differences are summed over all the <span class="math notranslate nohighlight">\(m\)</span> examples and divided by <code class="docutils literal notranslate"><span class="pre">2m</span></code> to produce the cost, <span class="math notranslate nohighlight">\(J(w,b)\)</span>.
&gt;Note, in lecture summation ranges are typically from 1 to m, while code will be from 0 to m-1.</p></li>
</ul>
<p>The code below calculates cost by looping over each example. In each loop: - <code class="docutils literal notranslate"><span class="pre">f_wb</span></code>, a prediction is calculated - the difference between the target and the prediction is calculated and squared. - this is added to the total cost.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_cost</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the cost function for linear regression.</span>

<span class="sd">    Args:</span>
<span class="sd">      x (ndarray (m,)): Data, m examples</span>
<span class="sd">      y (ndarray (m,)): target values</span>
<span class="sd">      w,b (scalar)    : model parameters</span>

<span class="sd">    Returns</span>
<span class="sd">        total_cost (float): The cost of using w,b as the parameters for linear regression</span>
<span class="sd">               to fit the data points in x and y</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># number of training examples</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">cost_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">f_wb</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_wb</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">cost_sum</span> <span class="o">=</span> <span class="n">cost_sum</span> <span class="o">+</span> <span class="n">cost</span>
    <span class="n">total_cost</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">))</span> <span class="o">*</span> <span class="n">cost_sum</span>

    <span class="k">return</span> <span class="n">total_cost</span>
</pre></div>
</div>
</div>
</section>
<section id="Cost-Function-Intuition">
<h2>Cost Function Intuition<a class="headerlink" href="#Cost-Function-Intuition" title="Permalink to this headline"></a></h2>
<p><img alt="f2b25c16724a430d9766d0c8721b8313" src="../../../../_images/C1_W1_Lab02_GoalOfRegression.PNG" /> Your goal is to find a model <span class="math notranslate nohighlight">\(f_{w,b}(x) = wx + b\)</span>, with parameters <span class="math notranslate nohighlight">\(w,b\)</span>, which will accurately predict house values given an input <span class="math notranslate nohighlight">\(x\)</span>. The cost is a measure of how accurate the model is on the training data.</p>
<p>The cost equation (1) above shows that if <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(b\)</span> can be selected such that the predictions <span class="math notranslate nohighlight">\(f_{w,b}(x)\)</span> match the target data <span class="math notranslate nohighlight">\(y\)</span>, the $(f_{w,b}(x^{(i)}) - y<sup>{(i)})</sup>2 $ term will be zero and the cost minimized. In this simple two point example, you can achieve this!</p>
<p>In the previous lab, you determined that <span class="math notranslate nohighlight">\(b=100\)</span> provided an optimal solution so let’s set <span class="math notranslate nohighlight">\(b\)</span> to 100 and focus on <span class="math notranslate nohighlight">\(w\)</span>.</p>
<p>Below, use the slider control to select the value of <span class="math notranslate nohighlight">\(w\)</span> that minimizes cost. It can take a few seconds for the plot to update.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt_intuition</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "edfdeb101ed24a93bfe261e6233f0071"}</script></div>
</div>
<p>The plot contains a few points that are worth mentioning. - cost is minimized when <span class="math notranslate nohighlight">\(w = 200\)</span>, which matches results from the previous lab - Because the difference between the target and pediction is squared in the cost equation, the cost increases rapidly when <span class="math notranslate nohighlight">\(w\)</span> is either too large or too small. - Using the <code class="docutils literal notranslate"><span class="pre">w</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> selected by minimizing cost results in a line which is a perfect fit to the data.</p>
</section>
<section id="Cost-Function-Visualization--3D">
<h2>Cost Function Visualization- 3D<a class="headerlink" href="#Cost-Function-Visualization--3D" title="Permalink to this headline"></a></h2>
<div class="line-block">
<div class="line">You can see how cost varies with respect to <em>both</em> <code class="docutils literal notranslate"><span class="pre">w</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> by plotting in 3D or using a contour plot.</div>
<div class="line">It is worth noting that some of the plotting in this course can become quite involved. The plotting routines are provided and while it can be instructive to read through the code to become familiar with the methods, it is not needed to complete the course successfully. The routines are in lab_utils_uni.py in the local directory.</div>
</div>
<section id="Larger-Data-Set">
<h3>Larger Data Set<a class="headerlink" href="#Larger-Data-Set" title="Permalink to this headline"></a></h3>
<p>It’s use instructive to view a scenario with a few more data points. This data set includes data points that do not fall on the same line. What does that mean for the cost equation? Can we find <span class="math notranslate nohighlight">\(w\)</span>, and <span class="math notranslate nohighlight">\(b\)</span> that will give us a cost of 0?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">])</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span>  <span class="mi">430</span><span class="p">,</span>   <span class="mi">630</span><span class="p">,</span> <span class="mi">730</span><span class="p">,])</span>
</pre></div>
</div>
</div>
<p>In the contour plot, click on a point to select <code class="docutils literal notranslate"><span class="pre">w</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> to achieve the lowest cost. Use the contours to guide your selections. Note, it can take a few seconds to update the graph.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">dyn_items</span> <span class="o">=</span> <span class="n">plt_stationary</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">updater</span> <span class="o">=</span> <span class="n">plt_update_onclick</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">dyn_items</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "191ddac06b504f7b815bb4ebd6455afd"}</script></div>
</div>
<p>Above, note the dashed lines in the left plot. These represent the portion of the cost contributed by each example in your training set. In this case, values of approximately <span class="math notranslate nohighlight">\(w=209\)</span> and <span class="math notranslate nohighlight">\(b=2.4\)</span> provide low cost. Note that, because our training examples are not on a line, the minimum cost is not zero.</p>
</section>
<section id="Convex-Cost-surface">
<h3>Convex Cost surface<a class="headerlink" href="#Convex-Cost-surface" title="Permalink to this headline"></a></h3>
<p>The fact that the cost function squares the loss ensures that the ‘error surface’ is convex like a soup bowl. It will always have a minimum that can be reached by following the gradient in all dimensions. In the previous plot, because the <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(b\)</span> dimensions scale differently, this is not easy to recognize. The following plot, where <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are symmetric, was shown in lecture:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">soup_bowl</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "3dba37647ea9464aba900e726d0bc246"}</script></div>
</div>
</section>
</section>
</section>
<section id="Congratulations!">
<h1>Congratulations!<a class="headerlink" href="#Congratulations!" title="Permalink to this headline"></a></h1>
<p>You have learned the following: - The cost equation provides a measure of how well your predictions match your training data. - Minimizing the cost can provide optimal values of <span class="math notranslate nohighlight">\(w\)</span>, <span class="math notranslate nohighlight">\(b\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andrew Ng.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>